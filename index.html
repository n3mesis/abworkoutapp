<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HIIT Timer</title>
<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background: #111;
        color: #fff;
    }
    #workoutLabel {
        font-size: 2rem;
        margin-bottom: 20px;
        text-align: center;
    }
    #timerContainer {
        display: flex;
        align-items: center;
        font-size: 3rem;
        gap: 60px;
    }
    #workoutNumber {
        color: pink;
        font-weight: bold;
    }
    #timer {
        font-weight: bold;
    }
    #controls {
        margin-top: 30px;
        display: flex;
        gap: 20px;
    }
    button {
        padding: 10px 20px;
        font-size: 1.2rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }
    button#start { background-color: #4CAF50; color: white; }
    button#pause { background-color: #f44336; color: white; }
</style>
</head>
<body>

<div id="workoutLabel">Press Start</div>
<div id="timerContainer">
    <div id="workoutNumber">1</div>
    <div id="timer">00:20</div>
</div>

<div id="controls">
    <button id="start">Start</button>
    <button id="pause">Pause</button>
</div>

<audio id="doneSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<script>
const workouts = [
    "Mountain Climbers",
    "Bicycle Crunch",
    "Plank Jacks",
    "Leg Raises",
    "Flutter Kicks",
    "Plank",
    "Russian Twist",
    "Reverse Crunch"
];

let currentWorkout = 0;
let isRunning = false;
let timer;
let seconds = 20;

const workoutLabel = document.getElementById("workoutLabel");
const timerEl = document.getElementById("timer");
const workoutNumberEl = document.getElementById("workoutNumber");
const startBtn = document.getElementById("start");
const pauseBtn = document.getElementById("pause");
const doneSound = document.getElementById("doneSound");

// Speech function
function speak(text) {
    if ('speechSynthesis' in window) {
        const utter = new SpeechSynthesisUtterance(text);
        window.speechSynthesis.speak(utter);
    }
}

// Start/pause functionality
startBtn.addEventListener("click", () => {
    if (!isRunning) {
        isRunning = true;
        if (!timer) startWorkout();
    }
});

pauseBtn.addEventListener("click", () => {
    isRunning = false;
    clearInterval(timer);
    timer = null;
});

function startWorkout() {
    seconds = 20;
    workoutLabel.textContent = `${workouts[currentWorkout]} starting`;
    speak(`${workouts[currentWorkout]} starting`);
    workoutNumberEl.textContent = currentWorkout + 1;
    updateTimerDisplay();

    timer = setInterval(() => {
        if (!isRunning) return;

        // Trigger 3-2-1 Rest voice cue when timer hits 3
        if (seconds === 3) {
            speak("3");
        } else if (seconds === 2) {
            speak("2");
        } else if (seconds === 1) {
            speak("1");
        } else if (seconds === 0) {
            speak("Rest");
        }

        seconds--;
        updateTimerDisplay();

        if (seconds < 0) {
            clearInterval(timer);
            startRest();
        }
    }, 1000);
}

function startRest() {
    seconds = 10;
    workoutLabel.textContent = "Resting";
    updateTimerDisplay();

    timer = setInterval(() => {
        if (!isRunning) return;

        seconds--;
        updateTimerDisplay();

        if (seconds < 0) {
            clearInterval(timer);
            currentWorkout++;
            if (currentWorkout < workouts.length) {
                startWorkout();
            } else {
                workoutLabel.textContent = "Workout Done!";
                speak("Workout done");
                doneSound.play();
                timer = null;
                isRunning = false;
            }
        }
    }, 1000);
}

function updateTimerDisplay() {
    let min = Math.floor(seconds / 60);
    let sec = seconds % 60;
    timerEl.textContent = `${String(min).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
}
</script>

</body>
</html>
